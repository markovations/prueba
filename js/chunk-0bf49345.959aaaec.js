(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0bf49345"],{"196f":function(e,s,a){},"27b2":function(e,s,a){},7101:function(e,s,a){"use strict";a.r(s);var r=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("div",[a("div",{staticClass:"login-asistencia"},[a("div",{staticClass:"contenedor-login"},[a("div",{staticClass:"box100"},[a("form",{staticClass:"formulario validate-form",staticStyle:{width:"500px","margin-left":"auto"},attrs:{"data-vv-scope":"login"},on:{submit:function(s){s.preventDefault(),e.validateBeforeSubmit("login")}}},[e._m(0),0!=e.cantEmpresas&&e.showEmpresas?a("div",{staticClass:"form-group"},[e._m(1),a("multiselect",{attrs:{options:e.OptionsEmpresas,searchable:!0,"show-labels":!0,label:"name","select-label":e.$t("multiselect.SELECTLABEL"),"deselect-label":e.$t("multiselect.DESELECTLABEL"),"selected-label":e.$t("multiselect.SELECTEDLABEL"),placeholder:e.$t("multiselect.PICKVALUE")},model:{value:e.empresa,callback:function(s){e.empresa=s},expression:"empresa"}},[a("template",{slot:"noOptions"},[e._v(e._s(e.$t("multiselect.LISTEMPTY")))]),a("template",{slot:"noResult"},[e._v(e._s(e.$t("multiselect.NORESULT")))])],2)],1):e._e(),a("span",{staticClass:"label-input100"},[a("i",{staticClass:"far fa-user"}),e._v("\n            "+e._s(e.$t("autenticacion.USUARIO"))+"\n          ")]),a("div",{staticClass:"form-group"},[a("div",{staticClass:"input-group with-focus"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.User,expression:"User"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"form-control":!0,"is-invalid":e.errors.has("login.user")},attrs:{type:"text",name:"user"},domProps:{value:e.User},on:{keyup:function(s){e.onKeyUp()},input:function(s){s.target.composing||(e.User=s.target.value)}}}),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("login.user"),expression:"errors.has('login.user')"}],staticClass:"invalid-feedback"},[e._v(e._s(e.errors.first("login.user")))])])]),a("span",{staticClass:"label-input100"},[a("i",{staticClass:"fas fa-lock"}),e._v("\n            "+e._s(e.$t("autenticacion.PASSWORD"))+"\n          ")]),a("div",{staticClass:"form-group"},[a("div",{staticClass:"input-group with-focus"},["checkbox"===e.passwordType?a("input",{directives:[{name:"model",rawName:"v-model",value:e.Password,expression:"Password"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"form-control":!0,"is-invalid":e.errors.has("login.password")},attrs:{name:"password",type:"checkbox"},domProps:{checked:Array.isArray(e.Password)?e._i(e.Password,null)>-1:e.Password},on:{change:function(s){var a=e.Password,r=s.target,t=!!r.checked;if(Array.isArray(a)){var o=null,i=e._i(a,o);r.checked?i<0&&(e.Password=a.concat([o])):i>-1&&(e.Password=a.slice(0,i).concat(a.slice(i+1)))}else e.Password=t}}}):"radio"===e.passwordType?a("input",{directives:[{name:"model",rawName:"v-model",value:e.Password,expression:"Password"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"form-control":!0,"is-invalid":e.errors.has("login.password")},attrs:{name:"password",type:"radio"},domProps:{checked:e._q(e.Password,null)},on:{change:function(s){e.Password=null}}}):a("input",{directives:[{name:"model",rawName:"v-model",value:e.Password,expression:"Password"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],class:{"form-control":!0,"is-invalid":e.errors.has("login.password")},attrs:{name:"password",type:e.passwordType},domProps:{value:e.Password},on:{input:function(s){s.target.composing||(e.Password=s.target.value)}}}),a("div",{staticClass:"input-group-append",on:{click:e.showPwd}},[a("span",{staticClass:"input-group-text text-muted bg-transparent"},[a("em",{class:"password"===e.passwordType?"fas fa-eye-slash":"fas fa-eye"})])]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.errors.has("login.password"),expression:"errors.has('login.password')"}],staticClass:"invalid-feedback"},[e._v(e._s(e.errors.first("login.password")))])])]),a("div",{staticClass:"flex-sb-m w-full p-t-3 p-b-32"},[a("div",{staticClass:"contact100-form-checkbox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.recordarme,expression:"recordarme"}],staticClass:"input-checkbox100",attrs:{id:"ckb1",type:"checkbox",name:"recordarme"},domProps:{checked:Array.isArray(e.recordarme)?e._i(e.recordarme,null)>-1:e.recordarme},on:{change:function(s){var a=e.recordarme,r=s.target,t=!!r.checked;if(Array.isArray(a)){var o=null,i=e._i(a,o);r.checked?i<0&&(e.recordarme=a.concat([o])):i>-1&&(e.recordarme=a.slice(0,i).concat(a.slice(i+1)))}else e.recordarme=t}}}),a("label",{staticClass:"label-checkbox100",attrs:{for:"ckb1"}},[e._v(e._s(e.$t("autenticacion.RECORDARME")))])])]),a("div",{staticClass:"container-login100-form-btn"},[a("button",{staticClass:"login100-form-btn"},[e._v(e._s(e.$t("autenticacion.INGRESAR")))])]),a("div",{staticClass:"forgetpass"},[a("router-link",{staticClass:"txt1",attrs:{to:"/recuperar",tag:"a"}},[e._v("¿Olvidaste tu contraseña?")])],1)]),a("div",{staticClass:"banner",staticStyle:{"background-image":"url('img/img-banner.png')"}})])])])])},t=[function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("span",{staticClass:"tituloformulario p-b-43"},[a("img",{attrs:{src:"img/logo-markovations.png",width:"300px"}})])},function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("span",{staticClass:"label-input100"},[a("i",{staticClass:"far fa-building"}),e._v(" Empresa\n            ")])}],o=(a("097d"),a("2b0e")),i=a("7bb1"),n=a("bc3a"),l=a.n(n),c=a("3d20"),d=a.n(c),u=a("a65d"),m=a.n(u),p=a("8e5f"),v=a.n(p);o["default"].use(m.a),o["default"].use(i["a"],{fieldsBagName:"formFields"});var h={components:{Multiselect:v.a},data:function(){return{login:{user:"",password:"",rememberme:!1},passwordType:"password",empresa:this.getEmpresa(),recordarme:this.$store.state.session.usuario.recordarme,User:this.getUser(),Password:this.getPassword(),showEmpresas:this.getshowEmpresas()}},computed:{OptionsEmpresas:function(){return this.$store.state.session.empresas},cantEmpresas:function(){return this.$store.state.session.empresas.length}},mounted:function(){this.$store.dispatch("session/GET_EMPRESAS")},methods:{onKeyUp:function(){"admin"==this.User?(this.showEmpresas=!1,this.empresa={value:1,name:""}):this.showEmpresas=!0},getUser:function(){var e=this.$store.state.session.usuario.recordarme;return e?this.$store.state.session.usuario.user:""},getPassword:function(){var e=this.$store.state.session.usuario.recordarme;return e?this.$store.state.session.usuario.password:""},getEmpresa:function(){var e=this.$store.state.session.usuario.recordarme;return e?this.$store.state.session.usuario.empresa:null},getshowEmpresas:function(){var e=this.$store.state.session.usuario.recordarme;return!e||("admin"==this.$store.state.session.usuario.user?(this.empresa={value:1,name:""},!1):(this.empresa=null,!0))},validateBeforeSubmit:function(e){var s=this;this.$validator.validateAll(e).then(function(e){if(e){var a=s.User,r=s.Password;null==s.empresa&&(s.empresa={value:1,name:""}),l.a.get("https://localhost:44386/api/autenticacion/ObtenerBloqueUsuario/",{params:{user:a,empresa:s.empresa.value}}).then(function(e){var t=e.data;if(1==t)d.a.fire({title:"Acceso denegado",text:"Cuenta bloqueada, comuníquese con el administrador del sistema.",type:"error",showConfirmButton:!1,toast:!0,timer:5e3,position:"top"});else{var o="";o="admin"==a?1:s.empresa.value,l.a.get("https://localhost:44386/api/autenticacion/ValidarCredenciales/",{params:{user:a,password:r,empresa:o}}).then(function(e){var a=e.data;if(a.length>0){!0,s.$store.dispatch("session/SELECCION_EMPRESA",{data:s.empresa}),localStorage.setItem("iduserlogeado",a[0]["usuario_id"]);var r="es";1==a[0]["idioma"]?r="es":2==a[0]["idioma"]&&(r="en");var t="",o="";1==a[0]["rol_id"]?(t=0,o=""):(t=a[0]["empresa_id"],o=a[0]["empresa"]),localStorage.setItem("idiomausuario",r),s.$store.dispatch("session/GET_INFOLOGIN",{idusuario:a[0]["usuario_id"],user:a[0]["user"],password:a[0]["password"],nomusuario:a[0]["nombres"],cargo:a[0]["cargo"],foto:a[0]["foto"],idioma:r,email:a[0]["correo"],empresaid:t,empresa:o,cambiocontra:a[0]["cambiocontra"],rolid:a[0]["rol_id"],rol:a[0]["rol"],recordarme:s.recordarme}),s.$store.dispatch("session/GET_UBIGEO",{nombre:"Pais"}),s.$store.dispatch("session/GET_UBIGEO",{nombre:"Departamento"}),s.$store.dispatch("session/GET_UBIGEO",{nombre:"Distrito"}),s.$store.dispatch("session/GET_UBIGEO",{nombre:"Provincia"}),s.$i18n.i18next.changeLanguage(r),s.$store.dispatch("session/UPDATE_LANGUAGE",{idioma:r}),s.$store.dispatch("session/INTENTOS_SESSION",{empresaid:s.empresa.value,user:s.login.user,logeado:1}),l.a.get("https://localhost:44386/api/autenticacion/ObtenerVigenciaCredenciales/",{params:{empresa:s.empresa.value,usuario:a[0]["usuario_id"]}}).then(function(e){var r=e.data;if(0==r)d.a.fire({title:"Contraseña caducada",text:"Su contraseña ha expirado",type:"error",showConfirmButton:!1,toast:!0,timer:6e3,position:"top"}),localStorage.setItem("vigenciacontra",0),s.$router.push("/cambiar");else{localStorage.setItem("vigenciacontra",1),s.$store.dispatch("session/GET_MENUROL",{usuario:a[0]["usuario_id"],accesoempresa:0});var t="";t="admin"==a[0]["user"]?1:a[0]["empresa_id"],s.$store.dispatch("permisos/GET_PERMISOUSUARIO",{empresa:t,rol:a[0]["rol_id"]}),s.$session.set("menu",[]),localStorage.setItem("rol",1),localStorage.setItem("accesoempresa",0)}}).catch(function(e){console.log(e),s.errored=!0}).finally(function(){return s.loading=!1})}else s.$store.dispatch("session/INTENTOS_SESSION",{empresaid:s.empresa.value,user:s.login.user,logeado:0}),d.a.fire({title:"Acceso denegado",text:"Por favor ingrese credenciales válidas.",type:"error",showConfirmButton:!1,toast:!0,timer:5e3,position:"top"})}).catch(function(e){console.log(e),s.errored=!0}).finally(function(){return s.loading=!1})}}).catch(function(e){console.log(e)}).finally(function(){return s.loading=!1})}})},showPwd:function(){"password"===this.passwordType?this.passwordType="":this.passwordType="password"}}},f=h,g=(a("eeb1"),a("9aa7"),a("2877")),w=Object(g["a"])(f,r,t,!1,null,null,null);s["default"]=w.exports},"9aa7":function(e,s,a){"use strict";var r=a("196f"),t=a.n(r);t.a},eeb1:function(e,s,a){"use strict";var r=a("27b2"),t=a.n(r);t.a}}]);